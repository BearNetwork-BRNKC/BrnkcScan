#!/usr/bin/env bash

set -e
# 如果 2 分鐘後仍未收到響應，則超時
timeout 120s bash <<EOT
# 等到 HTTP 請求成功localhost:PORT
function ping_server(){
    while true; do
        if curl -sSf "http://localhost:4000" >/dev/null; then
            exit 0
        fi
    done
}

ping_server
EOT
